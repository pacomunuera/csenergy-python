# -*- coding: utf-8 -*-
"""
Created on Sat Apr 25 11:29:44 2020

@author: paco
"""
# -*- coding: utf-8 -*-

import numpy as np
import matplotlib.pyplot as plt






mu = [5.1346826,
         -0.08395359,
         0.00059705155,
         -2.409221e-06,
         6.0292345e-09,
         -9.5788095e-12,
         9.4330297e-15,
         -5.2644e-18,
         1.274782e-21]


# xl = [288,298,308,318,328,338,348,358,368,378,388,398,408,418,428,438,448,
#       458,468,478,488,498,508,518,528,538,548,558,568,578,588,598,608,618,
#       628,638,648,658,668,678,688,698,708,718,728,738,748,758,768,778,788,798]


# yl = [0.004716936771976501,0.00368966373893824,0.002950062266603241,
#       0.002404218041467343,0.001992485540943706,0.0016758533625425601,
#       0.001428128577958499,0.0012313070896919007,0.0010727491924272083,
#       0.0009434100156389366,0.0008367038307147932,0.0007477590142338396,
#       0.0006729194050042499,0.0006094043885259677,0.0005550732401759549,
#       0.0005082591867871916,0.0004676508669218324,0.0004322065132913724,
#       0.00040109104914953867,0.00037362944452363437,0.0003492717541073222,
#       0.0003275666453367051,0.00030814116434533254,0.00029068513186329735,
#       0.00027493900864076527,0.00026068438435429406,0.00024773646719967465,
#       0.00023593811152839927,0.0002251550368885236,0.0002152719766249639,
#       0.00020618955671365842,0.00019782175197972725,0.00019009380166932398,
#       0.00018294049262593566,0.0001763047382989309,0.00017013639710003562,
#       0.00016439128539828915,0.00015903034956907277,0.00015401896862604557,
#       0.000149909,0.000145818,0.000141727,0.000137636,0.000133545,0.000129455,
#       0.000125364,0.000121273,0.000117182,0.000113091,0.000109,0.000104909,
#       0.000100818]

xl = [12,15,20,25,30,35,40,45,50,55,60,65,70,75,80,85,90,95,100,105,110,115,
      120,125,130,135,140,145,150,155,160,165,170,175,180,185,190,195,200,205,
      210,215,220,225,230,235,240,245,250,255,257.1,260,265,270,275,280,285,
      290,295,300,305,310,315,320,325,330,335,340,345,350,355,360,365,370,375,
      380,385,390,395,400,405,410,415,420,425]

yl = [5.52,5.00,4.29,3.71,3.25,2.87,2.56,2.30,2.07,1.88,1.72,1.58,1.46,1.35,
      1.25,1.17,1.09,1.03,0.97,0.91,0.86,0.82,0.77,0.73,0.70,0.67,0.64,0.61,
      0.58,0.56,0.53,0.51,0.49,0.47,0.46,0.44,0.42,0.41,0.39,0.38,0.37,0.35,
      0.34,0.33,0.32,0.31,0.30,0.29,0.28,0.27,0.27,0.27,0.26,0.25,0.24,0.24,
      0.23,0.22,0.22,0.21,0.20,0.20,0.19,0.19,0.18,0.18,0.17,0.17,0.17,0.16,
      0.16,0.15,0.15,0.15,0.14,0.14,0.14,0.13,0.13,0.13,0.12,0.12,0.12,0.11,
      0.11]

# poly = np.polynomial.polynomial.Polynomial(mu)


# xl = []
# yl = []

# xl = [x + 273.15 for x in xl]
# yl = [y * 0.001 for y in yl]

# for t in range(15,450,5):
#     xl.append(t)
#     yl.append(poly(t))


sols = {}
for grado in range(8,9):
  z = np.polyfit(xl, yl, grado, full=True)
  sols[grado] = z

# Pintar datos
plt.plot(xl, yl, 'o')

#Pintar curvas de ajuste
xp = np.linspace(12,475,10000)
for grado, sol in sols.items():
  coefs, error, *_ = sol
  p = np.poly1d(coefs)
  plt.plot(xp, p(xp), "-", label="Gr: %s. Error %.3f" % (grado, error) )
  # plt.plot(xp, poly(xp), "-", label="COEFIFICINTES PDF")
  print(coefs)
plt.legend()



